0 POKE 106,112:GRAPHICS 24:POKE 710,0:OPEN #1,4,0,"H:VBI.XEX":FOR I=0 TO 5:GET #1,D:NEXT I:POKE 712,16:POKE 559,0›5 FOR I=38912 TO 40314:GET #1,A:POKE I,A:NEXT I:CLOSE #1›10 GRAPHICS 0:POKE 559,62:? "Part 1 or 2 ";:POKE 764,255:INPUT PART›15 POKE 559,0:POKE 560,0:POKE 561,152:POKE 559,62:POKE 710,0:POKE 54279,144:POKE 53277,3›17 POKE 1536,0:POKE 1537,0:POKE 1538,0›20 X=USR(40039,148):POKE 704,40:POKE 705,36:DIR=203:PX=204:PY=205:X=0:Y=0:DR=0›25 OPEN #1,4,0,"H:INPUT.TXT":XM=61:YM=125:POKE DIR,0:D=0:DIM S$(3)›30 GET #1,D:DR=DR+(D=ASC("R"))-(D=ASC("L")):DR=DR+4*(DR=-1)-4*(DR=4):POKE DIR,DR*6:PS=0:S$=""›35 GET #1,D:IF D<>10 AND D<>ASC(",") THEN PS=PS+1:S$(PS)=CHR$(D):GOTO 35›40 DST=VAL(S$)›45 X=X+(DR=1)-(DR=3):Y=Y+(DR=2)-(DR=0):POKE PX,76+INT(X/2):POKE PY,Y+140:DST=DST-1›50 Z=USR(39962,Y+125,X+3):SOUND 0,0,0,2:SOUND 0,0,0,0:S$="000":S$(4-LEN(STR$(ABS(X)+ABS(Y))))=STR$(ABS(X)+ABS(Y))›52 IF LEN(S$)=1 THEN S$(3)=S$(1):S$(1)="0":S$(2)="0"›53 IF LEN(S$)=2 THEN S$(3)=S$(2):S$(2)=S$(1):S$(1)="0"›55 POKE 1536,ASC(S$(1))-48:POKE 1537,ASC(S$(2))-48:POKE 1538,ASC(S$(3))-48›57 IF PART=2 AND Z=1 THEN 65›58 IF DST>0 THEN 45›60 IF D<>10 THEN GET #1,D:GOTO 30›65 POKE 704,PEEK(20):POKE 705,PEEK(20)/2:SOUND 0,(255-PEEK(20))*9,10,6:SOUND 1,PEEK(20)*5,0,6›67 SOUND 2,PEEK(20)*20,12,9:IF PEEK(764)=255 THEN 65›70 SOUND 0,0,0,0:SOUND 1,0,0,0:SOUND 2,0,0,0:POKE PX,0:RUN ›